<!doctype html public "-//W3C//DTD HTML 4.0 Frameset//EN""http://www.w3.org/TR/REC-html40/frameset.dtd">
<html>
<head>
<title>
Jugl Overview
</title>
<link rel ="stylesheet" type="text/css" href="stylesheet.css" title="Style">
<script>
function asd() {
	
		parent.document.title="Attribute.js Overview";
	
}
</script>
</head>
<body bgcolor="white" onload="asd();">

<!-- ========== START OF NAVBAR ========== -->
<a name="navbar_top"><!-- --></a>
<table border="0" width="100%" cellpadding="1" cellspacing="0">
<tr>
<td colspan=2 bgcolor="#EEEEFF" class="NavBarCell1">
<a name="navbar_top_firstrow"><!-- --></a>
<table border="0" cellpadding="0" cellspacing="3">
  <tr align="center" valign="top">
  
  
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-summary.html"><font class="NavBarFont1"><b>Overview</b></font></a>&nbsp;</td>
  <td bgcolor="#FFFFFF" class="NavBarCell1Rev">	&nbsp;<font class="NavBarFont1Rev"><b>File</b></font>&nbsp;</td>
  

  <td bgcolor="#FFFFFF" class="NavBarCell1"> 	<font class="NavBarFont1">Class</font>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-tree.html"><font class="NavBarFont1"><b>Tree</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="index-all.html"--><font class="NavBarFont1"><b>Index</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="help-doc.html"><font class="NavBarFont1"><b>Help</b></font></a>&nbsp;</td>
  </tr>
</table>
</td>
<td bgcolor="#EEEEFF" align="right" valign="top">
<em>
<b>Jugl</b></em>
</td>
</tr>

<tr>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
&nbsp;PREV&nbsp;
&nbsp;NEXT</font></td>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
  <a href="index.html" target="_top"><b>FRAMES</b></a>  &nbsp;
&nbsp;<a href="overview-summary.html" target="_top"><b>NO FRAMES</b></a>
&nbsp;&nbsp;
<script>
  <!--
  if(window==top) {
    document.writeln('<A HREF="allclasses-noframe.html" TARGET=""><B>All Classes</B></A>');
  }
  //-->
</script>
<noscript>
<a href="allclasses-noframe.html" target=""><b>All Classes</b></a>
</noscript>
</font></td>
</tr>
</table>
<!-- =========== END OF NAVBAR =========== -->

<hr>
<center>
	
	   <h2>Attribute.js</h2>
	
</center>

	


<h4>Summary</h4>
<p>
	
		No overview generated for 'Attribute.js'<BR/><BR/>
	
</p>

<hr>



<!-- ========== METHOD SUMMARY =========== -->

<!-- ========== END METHOD SUMMARY =========== -->


        <pre class="sourceview">
Jugl.Attribute = Jugl.Class.create();
Jugl.Attribute.<span class="reserved">prototype</span> = {
    
    <span class="comment">/**
     * <span class="attrib">@param</span> {Jugl.Node} node
     * <span class="attrib">@param</span> {AttributeNode} element
     * <span class="attrib">@param</span> {String} type The localName of the attribute
     */</span>
    initialize: <span class="reserved">function</span>(node, element, type) {
        <span class="reserved">this</span>.owner = node;
        <span class="reserved">this</span>.element = element;
        <span class="reserved">this</span>.type = type;
        <span class="reserved">this</span>.nodeValue = element.nodeValue;
        <span class="reserved">this</span>.nodeName = element.nodeName;
        <span class="reserved">this</span>.parser = node.parser;
    },

    splitAttributeValue: <span class="reserved">function</span>(value) {
        value = (value != null) ? value : <span class="reserved">this</span>.nodeValue;
        var matches = <span class="reserved">this</span>.parser.regExes.trimSpace.exec(value);
        var items;
        <span class="reserved">if</span>(matches.length == 3) {
            items = [matches[1], matches[2]];
        }
        <span class="reserved">return</span> items;
    },
    
    getAttributeValues: <span class="reserved">function</span>() {
        var trimmed = <span class="reserved">this</span>.nodeValue.replace(/[\t\n]/g, <span class="literal">""</span>).replace(/;\s*$/, <span class="literal">""</span>);
        var tabbed = trimmed.replace(/;;/g, <span class="literal">"\t"</span>);
        var newlined = tabbed.split(<span class="literal">";"</span>).join(<span class="literal">"\n"</span>);
        <span class="reserved">return</span> newlined.replace(/\t/g, <span class="literal">";"</span>).split(/\n/g);
    },

    removeSelf: <span class="reserved">function</span>() {
        <span class="reserved">this</span>.owner.removeAttributeNode(<span class="reserved">this</span>);
    },
    
    process: <span class="reserved">function</span>() {
        <span class="reserved">return</span> <span class="reserved">this</span>.processAttribute[<span class="reserved">this</span>.type].apply(<span class="reserved">this</span>, []);
    },
    
    evalInScope: <span class="reserved">function</span>(str) {
        var expression = <span class="literal">"with(this.owner.scope){"</span> + str + <span class="literal">"}"</span>;
        <span class="reserved">return</span> eval(expression);
    },

    processAttribute: {

        <span class="comment">/**
         * Add a variable to the node's scope.  This variable can be used
         * in other attributes on this node, or by child nodes.  Access
         * the value of the variable in an attribute the variable name.
         * Child nodes defining variables with the same name as parent nodes
         * overwrite those variables for their own scope (and the scope of any
         * child nodes).
         *
         * <span class="attrib">@type</span> Boolean
         * <span class="attrib">@returns</span> A variable was defined
         */</span>
        define: <span class="reserved">function</span>() {
            var values = <span class="reserved">this</span>.getAttributeValues();
            var pair;
            <span class="reserved">for</span>(var i=0; i&lt;values.length; ++i) {
                pair = <span class="reserved">this</span>.splitAttributeValue(values[i]);
                <span class="reserved">this</span>.owner.scope[pair[0]] = <span class="reserved">this</span>.evalInScope(pair[1]);
            }
            <span class="reserved">this</span>.removeSelf();
            <span class="reserved">return</span> true;
        },

        <span class="comment">/**
         * Test the expression given in the attribute.  Continue processing
         * this node if the attribute's value expression evaluates to true.
         *
         * <span class="attrib">@type</span> Boolean
         * <span class="attrib">@returns</span> Continue processing this node.
         */</span>
        condition: <span class="reserved">function</span>() {
            var bool;
            try {
                bool = !!(<span class="reserved">this</span>.evalInScope(<span class="reserved">this</span>.nodeValue));
            } catch(err) {
                var message = err.name + <span class="literal">": "</span> + err.message + <span class="literal">"\n"</span>;
                message += <span class="literal">"attribute: "</span> + <span class="reserved">this</span>.nodeName;
                Jugl.Console.error(message);
                Jugl.Console.dirxml(<span class="reserved">this</span>.owner.element);
                Jugl.Console.log(<span class="reserved">this</span>.owner.scope);
            }
            <span class="reserved">this</span>.removeSelf();
            <span class="reserved">if</span>(!bool) {
                <span class="reserved">this</span>.owner.removeSelf();
            }
            <span class="reserved">return</span> bool;
        },

        <span class="comment">/**
         * <span class="attrib">@type</span> Boolean
         * <span class="attrib">@returns</span> Continue processing this node.
         */</span>
        repeat: <span class="reserved">function</span>() {
            var pair = <span class="reserved">this</span>.splitAttributeValue();
            var key = pair[0];
            var list = <span class="reserved">this</span>.evalInScope(pair[1]);
            <span class="reserved">this</span>.removeSelf();
            <span class="comment">/**
             * The repeat attribute sets the given variable to each element
             * in an array.  For objects (or anything besides an array)
             * the variable is set to each property in the object.  To get
             * a list of these properties, we iterate through them all here.
             */</span>
            <span class="reserved">if</span>(!(list instanceof Array)) {
                var items = new Array();
                <span class="reserved">for</span>(var p in list) {
                    items.push(p);
                }
                list = items;
            }
            <span class="comment">/**
             * Do the actual processing - inserting cloned nodes and finally
             * removing the original.
             */</span>
            var node;
            var previousSibling = <span class="reserved">this</span>.owner;
            var length = list.length;
            <span class="reserved">for</span>(var i=0; i&lt;length; ++i) {
                node = <span class="reserved">this</span>.owner.clone();
                node.scope[key] = list[i];
                node.scope.repeat[key] = {
                    index: i,
                    number: i + 1,
                    even: !(i % 2),
                    odd: !!(i % 2),
                    start: (i == 0),
                    end: (i == length-1),
                    length: length
                    <span class="comment">// not handling letter or Letter at this point</span>
                };
                previousSibling.insertAfter(node);
                node.process();
                previousSibling = node;
            }
            <span class="reserved">this</span>.owner.removeSelf();
            <span class="reserved">return</span> false;
        },

        <span class="comment">/**
         * <span class="attrib">@type</span> Boolean
         * <span class="attrib">@returns</span> The attribute value was successfully evaluated.
         */</span>
        content: <span class="reserved">function</span>() {
            var str;
            try {
                str = <span class="reserved">this</span>.evalInScope(<span class="reserved">this</span>.nodeValue);
            } catch(err) {
                var message = err.name + <span class="literal">": "</span> + err.message + <span class="literal">"\n"</span>;
                message += <span class="literal">"attribute: "</span> + <span class="reserved">this</span>.nodeName;
                Jugl.Console.error(message);
                Jugl.Console.dirxml(<span class="reserved">this</span>.owner.element);
                Jugl.Console.log(<span class="reserved">this</span>.owner.scope);
            }
            <span class="reserved">this</span>.removeSelf();
            var child = new Jugl.Node(<span class="reserved">this</span>.parser,
                                      document.createTextNode(str));
            <span class="reserved">this</span>.owner.removeChildNodes();
            <span class="reserved">this</span>.owner.appendChild(child);
            <span class="reserved">return</span> true;
        },

        <span class="comment">/**
         * <span class="attrib">@type</span> Boolean
         * <span class="attrib">@returns</span> The attribute value was successfully evaluated.
         */</span>
        replace: <span class="reserved">function</span>() {
            <span class="comment">// not yet implemented</span>
            <span class="reserved">return</span> false;
        },

        <span class="comment">/**
         * <span class="attrib">@type</span> Boolean
         * <span class="attrib">@returns</span> The attribute value was successfully evaluated.
         */</span>
        attributes: <span class="reserved">function</span>() {
            <span class="comment">// not yet implemented</span>
            <span class="reserved">return</span> false;
        }
    },
    
    CLASS_NAME: <span class="literal">"Jugl.Attribute"</span>
}</pre>
	<hr>



<!-- ========== START OF NAVBAR ========== -->
<a name="navbar_top"><!-- --></a>
<table border="0" width="100%" cellpadding="1" cellspacing="0">
<tr>
<td colspan=2 bgcolor="#EEEEFF" class="NavBarCell1">
<a name="navbar_top_firstrow"><!-- --></a>
<table border="0" cellpadding="0" cellspacing="3">
  <tr align="center" valign="top">
  
  
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-summary.html"><font class="NavBarFont1"><b>Overview</b></font></a>&nbsp;</td>
  <td bgcolor="#FFFFFF" class="NavBarCell1Rev">	&nbsp;<font class="NavBarFont1Rev"><b>File</b></font>&nbsp;</td>
  

  <td bgcolor="#FFFFFF" class="NavBarCell1"> <font class="NavBarFont1">Class</font>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-tree.html"><font class="NavBarFont1"><b>Tree</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="index-all.html"--><font class="NavBarFont1"><b>Index</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="help-doc.html"><font class="NavBarFont1"><b>Help</b></font></a>&nbsp;</td>
  </tr>
</table>
</td>
<td bgcolor="#EEEEFF" align="right" valign="top"><em>
<b>Jugl</b></em>
</td>
</tr>

<tr>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
&nbsp;PREV&nbsp;
&nbsp;NEXT</font></td>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
  <a href="index.html" target="_top"><b>FRAMES</b></a>  &nbsp;
&nbsp;<a href="overview-summary.html" target="_top"><b>NO FRAMES</b></a>
&nbsp;&nbsp;
<script>
  <!--
  if(window==top) {
    document.writeln('<A HREF="allclasses-noframe.html" TARGET=""><B>All Classes</B></A>');
  }
  //-->
</script>
<noscript>
<a href="allclasses-noframe.html" target=""><b>All Classes</b></a>
</noscript>
</font></td>
</tr>
</table>
<!-- =========== END OF NAVBAR =========== -->

<hr>
<font size="-1">

</font>
<div class="jsdoc_ctime">Documentation generated by <a href="http://jsdoc.sourceforge.net/" target="_parent">JSDoc</a> on Fri Jun 15 18:29:08 2007</div>
</body>
</html>
